$(window).on("beforeunload",()=>{}),e=!0,$(window).on("scroll",(function(){$(window).scrollTop()+$(window).height()>=$(document).height()-500&&getpost()})),$(window).on("load",()=>{getpost()});var sj=!0;function getpost(){var y=$(window).scrollTop(),adlimit=4;"/"!==$(location).attr("pathname")?url=$(location).attr("pathname")+"/getpost/":url="/index/getpost/",l=$(".loading"),sj&&(sj=!1,l.show(300),$.post(url,res=>{if(res.result){if(1===res.status&&(sj=!0),0===res.status)message='You should login for this <a href="/login">Let\'s login</a>',popup(message,"auto","warning",3e3);else if(1===res.status||2===res.status)try{r=res.result,lnd=res.lnd,counts=res.counts,r.forEach((post,abs)=>{(abs+1)%adlimit==0&&$(".posts").append(bannerTag),postid=post.postid,f=".post[data-post-id="+postid+"]",b=$(f+" .options div[class!=arrow]"),hidden='<a title="Hide post" class="visibility" href="javascript:void(0)"><i class="far fa-eye"></i> Make visible</a>',visible='<a title="Make the post visible" class="visibility" href="javascript:void(0)"><i class="far fa-eye-slash"></i> Make hidden</a>',d=new Date(post.createdAt),hour=d.getHours(),min=d.getMinutes(),day=d.getDate(),month=d.getMonth()+1,hour=hour<10?"0"+hour:hour,min=min<10?"0"+min:min,day=day<10?"0"+day:day,month=month<10?"0"+month:month,dd=day+"."+month+"."+String(d.getFullYear()).substring(2)+" "+hour+":"+min,a='<div class="post" style="display: none;" data-post-id="'+postid+'"><div class="header">\n            <div class="user">\n              <img class="lazyload" data-src="/img/80x80.jpg" alt="user profile">\n              <div class="u">\n                <a href="/'+res.username+'">\n                  '+res.username+"\n                  </a>\n                  "+(res.isverified?verifiedTag:"")+"\n                "+(res.visibility[abs]?"":hiddenTag)+'\n                <div class="pdate">\n                '+dd+'\n                </div>\n              </div>\n            </div>\n            <div class="more" title="Options">\n              <i class="fas fa-ellipsis-h"></i>\n            </div>\n            <div class="options">\n              <div class="arrow"></div>\n              <div>\n                '+(res.ismine?deleteTag:"")+"\n                "+shareTag+"               \n                "+reportTag+" \n                "+saveTag+"               \n                "+(res.ismine?res.visibility[abs]?visible:hidden:"")+'\n              </div>\n            </div>\n          </div>\n          <div class="article">\n            <p class="ptext">\n        \n            '+post.article+'\n            </p>\n            <div class="pmedia" style="display: none;">\n              <img class="lazyload" data-src="" alt="post img">\n            </div>\n          </div>\n          <div class="buttons">\n          \n          '+(res.lnd[abs][0]?'<img class="like" src="/img/arrow2.svg" alt="button">':'<img class="like" src="/img/arrow.svg" alt="button">')+"\n          \n          "+(res.lnd[abs][1]?'<img class="dislike" src="/img/arrow2.svg" alt="button">':'<img class="dislike" src="/img/arrow.svg" alt="button">')+'\n          </div>\n        \n          <div class="buttons">\n            +<span class="likes'+postid+'">\n            '+counts[abs][0]+'\n            </span>\n            /\n            -<span class="dislikes'+postid+'">\n            '+counts[abs][1]+'\n            </span>\n          </div>\n          <span class="commentcount">\n          '+counts[abs][2]+'&nbsp;comment\n          </span>\n          <div class="comments">\n            <div class="comment">\n            </div>\n          </div>\n        \n          <div class="sendcomment">\n            <form onsubmit="return false">\n              <input type="text">\n              <button type="button" class="send">Send</button>\n            </form>\n          </div></div>',$(".posts").append(a),$(f).show(100),$(f+" .like").on("click",e=>{like(e.currentTarget)}),$(f+" .more").on("click",e=>{more(e.currentTarget)}),$(f+" .dislike").on("click",e=>{dislike(e.currentTarget)}),$(f+" .send").on("click",e=>{send(e.currentTarget)}),$(f+" .del").on("click",e=>{del(e.currentTarget)}),$(f+" .save").on("click",e=>{save(e.currentTarget)}),$(f+" .report").on("click",e=>{$(".report-div").addClass("report-active"),$(".report-div .postid").html(postid),$(".options").hide(200)}),$(f+" .share").on("click",e=>{$(".share-div").addClass("share-active"),$(".options").hide(200),protocol=(window.location.protocol,"https:"),link=protocol+"//"+window.location.hostname+"/post/"+postid,text="Hey%2C%20you%20should%20see%20this%20post%0A",$(".link-cont .link").html(link),$(".link-cont .link").attr("title",link),$(".facebook").attr("href","https://www.facebook.com/sharer/sharer.php?u="+link),$(".twitter").attr("href","https://twitter.com/intent/tweet?url="+link+"&text="+text),$(".whatsapp").attr("href","https://wa.me/?text="+text+link),$(".pinterest").attr("href","https://pinterest.com/pin/create/button/?url="+link+"&media=&description="+text),$(".linkedin").attr("href","https://www.linkedin.com/shareArticle?mini=true&url="+link+"&title=&summary="+text+"&source="),$(".mail").attr("href","mailto:info@example.com?&subject="+text+"&body="+link)}),$(f+" .visibility").on("click",e=>{console.log("soon")})})}catch(error){$(".posts").append("Upload post error, Please refresh the page err:<br>"+error)}else if(4===res.status){adlimit=8,sj=!0;try{r=res.result,counts=res.counts,r.forEach((post,abs)=>{abs+1===adlimit&&(adlimit=0,$(".posts").append(bannerTag)),postid=post.postid,d=new Date(post.createdAt),h=d.getHours(),m=d.getMinutes(),h=h<=9?"0"+h:h,m=m<=9?"0"+m:m,dd=d.getDate()+"."+d.getMonth()+"."+String(d.getFullYear()).substring(2)+" "+h+":"+m,a='<div class="post"  style="display: none;" data-post-id="'+postid+'"><div class="header">\n            <div class="user">\n              <img class="lazyload" data-src="/img/80x80.jpg" alt="user profile">\n              <div class="u">\n                <a href="/'+res.usernames[abs]+'">\n                  '+res.usernames[abs]+"\n                  "+(res.isverified[abs]?verifiedTag:"")+'\n                </a>\n                <div class="pdate">\n                '+dd+'\n                </div>\n              </div>\n            </div>\n            <div class="more">\n              <i class="fas fa-ellipsis-h"></i>\n            </div>\n            <div class="options">\n              <div class="arrow">Â </div>\n              <div>\n              '+(res.ismine?deleteTag:"")+"\n              "+shareTag+"               \n              "+reportTag+" \n              "+saveTag+'        \n              </div>\n            </div>\n          </div>\n          <div class="article">\n            <p class="ptext">\n        \n            '+post.article+'\n            </p>\n            <div class="pmedia" style="display: none;">\n              <img class="lazyload" data-src="" alt="post img">\n            </div>\n          </div>\n          <div class="buttons">\n          \n          '+(res.lnd[abs][0]?'<img class="lazyload like" data-src="/img/arrow2.svg" alt="button">':'<img class="lazyload like" data-src="/img/arrow.svg" alt="button">')+"\n          \n          "+(res.lnd[abs][1]?'<img class="lazyload dislike" data-src="/img/arrow2.svg" alt="button">':'<img class="lazyload dislike" data-src="/img/arrow.svg" alt="button">')+'\n          </div>\n        \n          <div class="buttons">\n            +<span class="likes'+postid+'">\n            '+counts[abs][0]+'\n            </span>\n            /\n            -<span class="dislikes'+postid+'">\n            '+counts[abs][1]+'\n            </span>\n          </div>\n          <span class="commentcount"><span class="c">\n          '+counts[abs][2]+'</span>comment\n          </span>\n          <div class="comments">\n            <div class="comment">\n            </div>\n          </div>\n        \n          <div class="sendcomment">\n            <form onsubmit="return false">\n              <input type="text">\n              <button type="button" class="send">Send</button>\n            </form>\n          </div>\n          </div>',$(".posts").append(a),f=".post[data-post-id="+postid+"]",$(f).show(400),b=$(".post .options"),$(f+" .like").on("click",e=>{like(e.currentTarget)}),$(f+" .more").on("click",e=>{more(e.currentTarget)}),$(f+" .dislike").on("click",e=>{dislike(e.currentTarget)}),$(f+" .send").on("click",e=>{send(e.currentTarget)}),$(f+" .del").on("click",e=>{del(e.currentTarget)}),$(f+" .save").on("click",e=>{save(e.currentTarget)}),$(f+" .report").on("click",e=>{$(".report-div").addClass("report-active"),$(".report-div .postid").html(postid),$(".options").hide(200)}),$(f+" .share").on("click",e=>{$(".share-div").addClass("share-active"),$(".options").hide(200),protocol=(window.location.protocol,"https:"),link=protocol+"//"+window.location.hostname+"/post/"+postid,text="Hey%2C%20you%20should%20see%20this%20post%0A",$(".link-cont .link").html(link),$(".link-cont .link").attr("title",link),$(".facebook").attr("href","https://www.facebook.com/sharer/sharer.php?u=https://www.youtube.com/watch?v=74LAYoqo0p4"),$(".twitter").attr("href","https://twitter.com/intent/tweet?url="+link+"&text="+text),$(".whatsapp").attr("href","https://wa.me/?text="+text+link),$(".pinterest").attr("href","https://pinterest.com/pin/create/button/?url="+link+"&media=&description="+text),$(".linkedin").attr("href","https://www.linkedin.com/shareArticle?mini=true&url="+link+"&title=&summary="+text+"&source="),$(".signal").attr("href","signal://send?text="+text+link),$(".mail").attr("href","mailto:info@example.com?&subject="+text+"&body="+link)}),$(f+" .visibility").on("click",e=>{console.log("soon")})})}catch(error){$(".posts").append("Upload post error, Please refresh the page err:<br>"+error)}}}else 3===res.status?$(".posts").append(res.message):5===res.status?(message='This account has been suspended for a while. <a href="/faq/questionid" style="color: inherit">Why?</a>',$(".posts").append('<div style="margin-top:30px; padding: 10px 7px; font-size: 19px" class="warning">'+message+"</div>")):console.log("somethins broked. res => \n",res);l.hide()}))}verifiedTag='<span class="verified" title="Verified account"><i class="far fa-check-circle"></i></span>',hiddenTag='<span class="hidden" title="Hidden post, just you can see this post"><i class="far fa-eye-slash"></i></span>',shareTag='<a class="share" title="Share post" href="javascript:void(0)"><img class="lazyload" data-src="/img/share.svg" alt="">Share</a>',reportTag='<a class="report" title="Report post" href="javascript:void(0)"><img class="lazyload" data-src="/img/report.svg" alt="">Report</a>',saveTag='<a class="save" title="Save post" href="javascript:void(0)"><img class="lazyload" data-src="/img/save.svg" alt="">Save</a>',deleteTag='<a class="del" title="Delete post" href="javascript:void(0)"><img class="lazyload" data-src="/img/delete.svg" alt="">Delete</a>',bannerTag="";